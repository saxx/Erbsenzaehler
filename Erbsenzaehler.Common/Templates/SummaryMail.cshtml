@inherits RazorEngine.Templating.TemplateBase<Erbsenzaehler.SummaryMail.SummaryMailModel>

@{
    Layout = "_MailLayout.cshtml";
}


<div class="navbar">
    <img src="data:image/png;base64,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" />

    <p>Erbsenzähler: Zusammenfassung vom @Model.CurrentDate für @Model.ClientName</p>
</div>

<p>
    Hier ist Ihre aktuelle Zusammenfassung aus dem Erbsenzähler.
    Besuchen Sie <a href="@Model.ErbsenzaehlerUrl">@Model.ErbsenzaehlerUrl</a> für Details.
</p>

<h2>
    Saldo
</h2>

<table>
    <tr>
        <td class="text-muted">@Model.LastMonth</td>
        <td class="text-muted text-right">
            @(Model.LastMonthBalance > 0 ? "+" : "")@Model.LastMonthBalance.ToString("N2") €
        </td>
    </tr>
    <tr>
        <td>
            @Model.CurrentMonth
        </td>
        <td class="text-right @(Model.CurrentMonthBalance >= 0 ? "number-positive" : "number-negative")">
            @(Model.CurrentMonthBalance > 0 ? "+" : "")@Model.CurrentMonthBalance.ToString("N2") €
        </td>
    </tr>
</table>

<h2>
    Budgets
</h2>

@if (Model.CurrentMonthBudget.Any())
{
    <table>
        <tr>
            <th>Kategorie</th>
            <th class="text-muted">@Model.LastMonth</th>
            <th>@Model.CurrentMonth</th>
        </tr>

        @foreach (var category in Model.CurrentMonthBudget.Select(x => x.Category).ToList())
        {
            <tr>
                <td>
                    <span class="label label-info">
                        @category
                    </span>
                </td>
                <td class="text-muted text-right">@Model.LastMonthBudget.First(x => x.Category == category).Percentage %</td>
                <td class="text-right @(Model.CurrentMonthBudget.First(x => x.Category == category).Percentage <= 100 ? "number-positive" : "number-negative")">
                    @Model.CurrentMonthBudget.First(x => x.Category == category).Percentage %
                </td>
            </tr>
        }
    </table>
}
else
{
    <div class="alert alert-warning">Sie haben keine Budgets definiert.</div>
}

<h2>
    Einnahmen und Ausgaben
</h2>

@if (Model.SpendingCategories.Any())
{
    <table>
        <tr>
            <th>Kategorie</th>
            <th class="text-muted">@Model.LastMonth</th>
            <th>@Model.CurrentMonth</th>
        </tr>

        @foreach (var category in Model.SpendingCategories)
                {
            <tr>
                <td>
                    <span class="label label-info">
                        @category
                    </span>
                </td>
                <td class="text-muted text-right">
                    @(Model.LastMonthSpendings.ContainsKey(category) ? Model.LastMonthSpendings[category].ToString("N2") : "0") €
                </td>
                <td class="text-right">
                    @(Model.CurrentMonthSpendings.ContainsKey(category) ? Model.CurrentMonthSpendings[category].ToString("N2") : "0") €
                </td>
            </tr>
        }
    </table>
}
else
{
    <div class="alert alert-warning">Es sind keine Ein- oder Ausgaben im Erbsenzähler vermerkt.</div>
}

<h2>
    Neueste Buchungszeilen im Detail
</h2>

@if (Model.Lines.Any())
{
    <table>
        <tr>
            <th>Kategorie</th>
            <th>Datum</th>
            <th>Text</th>
            <th>Betrag</th>
        </tr>

        @foreach (var line in Model.Lines)
                {
            <tr>
                <td>
                    @if (!string.IsNullOrEmpty(line.Category))
                    {
                        <span class="label label-info">
                            @line.Category
                        </span>
                    }
                </td>
                <td>@line.Date</td>
                <td>@line.Text</td>
                <td class="text-right">@line.Amount</td>
            </tr>
        }
    </table>
}
else
{
    <div class="alert alert-warning">Es sind keine aktuellen Buchungszeilen im Erbsenzähler vermerkt.</div>
}
